(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{442:function(_,v,t){"use strict";t.r(v);var a=t(27),e=Object(a.a)({},(function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h2",{attrs:{id:"tcp-三次握手"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp-三次握手"}},[_._v("#")]),_._v(" TCP 三次握手")]),_._v(" "),t("p",[_._v("目的：确认双方均具有发送和接收数据的能力")]),_._v(" "),t("ul",[t("li",[_._v("第一次，客户端发送连接请求，标志位 SYN = 1，序号 seq = x，并进入 SYN_SEND 状态，[客户端发送能力]")]),_._v(" "),t("li",[_._v("第二次，服务端接收到客户端的连接请求，发送确认包，标志位 SYN = 1，ACK = 1，序号 seq = y，ack = x + 1，并进入 SYN_RECEIVED 状态；[服务端接收能力和发送能力]")]),_._v(" "),t("li",[_._v("第三次，客户端接收到服务端的应答请求，发送确认包，标志位 SYN = 0，ACK = 1，序号 ack = y + 1，并进入 ESTABLISHED 状态，服务器端接收到这个包时，也进入 ESTABLISHED 状态。[客户端具有接收能力]")])]),_._v(" "),t("p",[_._v("至此，TCP 握手结束。")]),_._v(" "),t("p",[_._v("「TP：欠一个手绘流程图：三次握手」")]),_._v(" "),t("h3",{attrs:{id:"四次挥手"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四次挥手"}},[_._v("#")]),_._v(" 四次挥手")]),_._v(" "),t("p",[_._v("目的：确认双方均失去发送和接收数据的能力")]),_._v(" "),t("ul",[t("li",[_._v("第一次，客户端发起断开连接请求，标志位 FIN = 1，序号 seq = x，并进入 FIN_WAIT_1 状态。[客户端失去发送能力]")]),_._v(" "),t("li",[_._v("第二次，服务端接收到断开连接请求，发送确认包，标志位 ACK = 1，序号 ack = x + 1，并进入 CLOSE_WAIT 状态。")]),_._v(" "),t("li",[_._v("第三次，服务端发送断开连接请求，标志位 FIN = 1，序号 seq = y，并进入 LAST_ACK 状态，等待来自客户端最后一个 ACK。[服务端失去发送能力]")]),_._v(" "),t("li",[_._v("第四次，客户端接收到断开连接请求，发送确认包，并进入 TIME_WAIT 状态，等待可能出现的重传 ACK 包。服务端接收到这个确认包之后，关闭连接，进入 CLOSED 状态。[服务端失去接收能力]")])]),_._v(" "),t("p",[_._v("客户端等待两个最大生命周期 2MSL 之后，没有收到服务端的 ACK，认为服务器端已正常关闭，于是也关闭连接，进入 CLOSED 状态。[客户端失去接收能力]")]),_._v(" "),t("p",[_._v("「TP：再欠一个手绘流程图：四次挥手」")]),_._v(" "),t("h3",{attrs:{id:"补充"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#补充"}},[_._v("#")]),_._v(" 补充")]),_._v(" "),t("p",[_._v("SYN 攻击")]),_._v(" "),t("p",[_._v("在三次握手过程中，服务器半连接状态下，需要收到 ACK 包才能进入 ESTABLISHED 状态。")]),_._v(" "),t("p",[_._v("SYN 攻击是指，攻击客户端 在短时间内伪造大量不存在的 IP 地址，向服务器不断地发送 SYN 包，服务器会不断回复确认包，并等待客户端的确认。因为源地址是伪造的、不存在的，所以服务器会不断的重发直至超时，这些伪造的 SYN 包将长时间占用未连接队列，正常的 SYN 请求就可能会被丢弃，导致目标系统运行缓慢，严重者甚至引起网络堵塞、系统瘫痪。")]),_._v(" "),t("p",[_._v("SYN 攻击是一种典型的 DDoS 攻击。")]),_._v(" "),t("p",[_._v("检测 SYN 攻击的方法")]),_._v(" "),t("p",[_._v("当看到服务器上有大量的半连接状态，特别是源 IP 地址随机分布，基本上可以断定是一次 SYN 攻击。")]),_._v(" "),t("p",[_._v("防御 SYN 攻击的方法")]),_._v(" "),t("ul",[t("li",[_._v("缩短 超时时间")]),_._v(" "),t("li",[_._v("增加最大半连接数")]),_._v(" "),t("li",[_._v("过滤网关防护")]),_._v(" "),t("li",[_._v("SYN cookies 技术")])]),_._v(" "),t("h3",{attrs:{id:"tcp-keepalive"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp-keepalive"}},[_._v("#")]),_._v(" TCP KeepAlive")]),_._v(" "),t("p",[_._v("基本原理：隔一段时间给连接对端发送一个探测包，如果收到对方回应的 ACK，则认为连接依旧存活；在超过一定重试次数之后还是没有收到对方的回应，则丢弃该 TCP 连接。")])])}),[],!1,null,null,null);v.default=e.exports}}]);